<!DOCTYPE html><html lang="en"><head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145799979-1"></script> <script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'UA-145799979-1'); </script> <link rel="preload" href="https://shortcutIV.com/includes/baseSiteStyling.css" as="style"> <link rel="preload" href="https://shortcutIV.com/includes/httpsRedirect.js" as="script"> <link rel="preload" href="https://shortcutIV.com/includes/escapedFooter.js" as="script"> <link rel="preload" href="https://shortcutIV.com/includes/sortingHat.js" as="script"> <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css" as="style"> <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js" as="script"> <link rel="preload" href="https://shortcutIV.com/includes/pokeList.js" as="script"> <title>ShortcutIV - PvP Search Strings</title> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="Pok&eacute;mon Go&trade; PvP search string generator to find your best (or trash the rest). By copy+pasting these strings into PoGo, you can quicky figure out what to power up and what to send to Professor Willow!"/> <script async src="https://shortcutIV.com/includes/httpsRedirect.js"></script> <link rel="apple-touch-icon" sizes="57x57" href="/favIcon/apple-icon-57x57.png"> <link rel="apple-touch-icon" sizes="60x60" href="/favIcon/apple-icon-60x60.png"> <link rel="apple-touch-icon" sizes="72x72" href="/favIcon/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="76x76" href="/favIcon/apple-icon-76x76.png"> <link rel="apple-touch-icon" sizes="114x114" href="/favIcon/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="120x120" href="/favIcon/apple-icon-120x120.png"> <link rel="apple-touch-icon" sizes="144x144" href="/favIcon/apple-icon-144x144.png"> <link rel="apple-touch-icon" sizes="152x152" href="/favIcon/apple-icon-152x152.png"> <link rel="apple-touch-icon" sizes="180x180" href="/favIcon/apple-icon-180x180.png"> <link rel="icon" type="image/png" sizes="192x192" href="/favIcon/android-icon-192x192.png"> <link rel="icon" type="image/png" sizes="32x32" href="/favIcon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="96x96" href="/favIcon/favicon-96x96.png"> <link rel="icon" type="image/png" sizes="16x16" href="/favIcon/favicon-16x16.png"> <link rel="manifest" href="/favIcon/manifest.json"> <meta name="msapplication-TileColor" content="#ffffff"> <meta name="msapplication-TileImage" content="/ms-icon-144x144.png"> <meta name="theme-color" content="#ffffff"> <link rel="stylesheet" href="https://shortcutIV.com/includes/baseSiteStyling.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css"> <script src="https://www.google.com/recaptcha/api.js?render=6LfY-KYUAAAAAIYnP89WU5GWU-MMg_uy0z_7t9c2"></script> <style>#leagueRanks{display:none;}input[type=number]{width: 42px;}</style></head><body onload="checkURI()"> <header> <ul class="header"> <li class="dropdown active"> <a href="javascript:void(0)" class="dropbtn active">PvP IVs</a> <div class="dropdown-content"> <a href="/">Rankings</a> <a href="/searchStr.html" class="active">Search Strings</a> </div></li><li class="dropdown"> <a href="javascript:void(0)" class="dropbtn">Typing</a> <div class="dropdown-content"> <a href="/typeLookup.html">Chart</a> <a href="/typeQuiz.html">Quiz</a> </div></li><li class="header" style="float:right"><a href="/about.html">About</a></li></ul> </header> <section> <br/> <input id="pokeList" onfocus="this.value=''" placeholder="Final Mon"/> <label> Top # Ranks: <input type="number" value="10" id="limit" min="1" max="4096" oninput="start()"> </label> <br/> <label>League:<select id="league" oninput="start()"> <option value="1500">Great League</option> <option value="2500">Ultra League</option> <option value="5000">Master League</option> <option value="All">All Leagues</option></select> </label> <label>Trash String:<input id="trash" type="checkbox" oninput="start()"></label><br/> <div id="leagueRanks"> GL Top:<input type="number" value="10" id="GLlimit" min="1" max="4096" oninput="start()"> UL Top:<input type="number" value="10" id="ULlimit" min="1" max="4096" oninput="start()"> ML Top:<input type="number" value="10" id="MLlimit" min="1" max="4096" oninput="start()"> </div><label>Only Find 0% IVs:<input id="onlyZero" type="checkbox" oninput="start()"></label><br/> <br/><br/> <textarea id="output" rows="10" style="width: 100%; height: 50%;" onclick="autocopy(this)"></textarea> <div id="outputSummaryBox"></div><div id="feedbackBox"></div><script src="https://shortcutIV.com/includes/escapedFooter.js"></script> <script src="https://shortcutIV.com/includes/sortingHat.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script> <script src="https://shortcutIV.com/includes/pokeList.js"></script><script>/* define Awesomeplete list https://leaverou.github.io/awesomplete/ */ var input=document.getElementById("pokeList"); var selected=undefined; var canonicalLink=true; var awesomplete=new Awesomplete(input,{list: pokeList, /* insert label instead of value into the input */ replace: function(suggestion){this.input.value=suggestion.label; selected=suggestion.label; start();}}); /* end Awesomeplete definitions https://leaverou.github.io/awesomplete/ */ var cpm=[0.094, 0.1351374318, 0.16639787, 0.192650919, 0.21573247, 0.2365726613, 0.25572005, 0.2735303812, 0.29024988, 0.3060573775, 0.3210876, 0.3354450362, 0.34921268, 0.3624577511, 0.3752356, 0.387592416, 0.39956728, 0.4111935514, 0.4225, 0.4329264091, 0.44310755, 0.4530599591, 0.4627984, 0.472336093, 0.48168495, 0.4908558003, 0.49985844, 0.508701765, 0.51739395, 0.5259425113, 0.5343543, 0.5426357375, 0.5507927, 0.5588305862, 0.5667545, 0.5745691333, 0.5822789, 0.5898879072, 0.5974, 0.6048236651, 0.6121573, 0.6194041216, 0.6265671, 0.6336491432, 0.64065295, 0.6475809666, 0.65443563, 0.6612192524, 0.667934, 0.6745818959, 0.6811649, 0.6876849038, 0.69414365, 0.70054287, 0.7068842, 0.7131691091, 0.7193991, 0.7255756136, 0.7317, 0.7347410093, 0.7377695, 0.7407855938, 0.74378943, 0.7467812109, 0.74976104, 0.7527290867, 0.7556855, 0.7586303683, 0.76156384, 0.7644860647, 0.76739717, 0.7702972656, 0.7731865, 0.7760649616, 0.77893275, 0.7817900548, 0.784637, 0.7874736075, 0.7903]; function checkURI(){var URL=window.location.href.split("?")[1]; /* URL="mon=Gyarados&r=169&cp=2500&o=00000&l=ko"; */ if (URL){URL=decodeURI(URL); /*console.log("Read URL as: "+URL); */ var values=URL.split("&"); /*console.log("Values array as: "+JSON.stringify(values)); */ for (var i=0; i<values.length; i++){switch (values[i].split("=")[0]){case "mon": selected=values[i].split("=")[1]; awesomplete.input.value=selected; break; case "r": document.getElementById('limit').value=values[i].split("=")[1]; break; case "cp": document.getElementById('league').value=values[i].split("=")[1]; break; case "o": var options=(''+values[i].split("=")[1]); if (options[0]==1){document.getElementById('trash').checked=true;}else{document.getElementById('trash').checked=false;}if (options[1]==1){document.getElementById('onlyZero').checked=true;}else{document.getElementById('onlyZero').checked=false;}if (options[2]==1){document.getElementById('hundo').checked=true;}else{document.getElementById('hundo').checked=false;}if (options[3]==1){document.getElementById('zero').checked=true;}else{document.getElementById('zero').checked=false;}if (options[4]==1){document.getElementById('base').checked=true;}else{document.getElementById('base').checked=false;}if (options[5]==1){document.getElementById('baby').checked=true;}else{document.getElementById('baby').checked=false;}if (options[6]==1){document.getElementById('short').checked=true;}else{document.getElementById('short').checked=false;}break; case "l": var lang=document.getElementById('lang'); var languages=lang.options.length; for (var j=0; j<languages; j++){if (lang.options[j].value.split(",")[0]==values[i].split("=")[1]){lang.options[j].selected=true; break;}}break;}}start(); return true;}else{console.log("No inputs detected, awaiting user input"); return false;}}function start(){if (((document.getElementById('league').value=="All") && (getComputedStyle(document.getElementById("leagueRanks"), null).display !="block")) || ((getComputedStyle(document.getElementById("leagueRanks"), null).display=="block") && (document.getElementById('league').value !="All"))){/* https://stackoverflow.com/questions/18353574/how-to-show-hide-div-on-selection-of-any-drop-down-value */ /* https://stackoverflow.com/questions/4866229/check-element-css-display-with-javascript */ document.getElementById("leagueRanks").style.display=(getComputedStyle(document.getElementById("leagueRanks"), null).display=="block") ? "none":"block";}/* exit if we haven't selected a mon yet */ if ((awesomplete.suggestions===undefined) && (selected===undefined)){console.log("No Pok&eacute;mon found by start(), received:'"+awesomplete.suggestions+"' and '"+selected+"'"); return;}else{if (selected===undefined){console.log("Invalid input detected:'"+awesomplete.suggestions+"' and '"+selected+"'"); return;}else{console.log("start: Found mon in both:'"+awesomplete.suggestions+"' and '"+selected+"'");}}var mon=''; /* need to ensure we have the right mon selected */ if (awesomplete.suggestions !==undefined){for (var i=0; i<awesomplete.suggestions.length; i++){if (selected==awesomplete.suggestions[i].label){/*console.log("mon set to selected==awesomplete.suggestions["+i+"].label:"+awesomplete.suggestions[i].label) */ mon=awesomplete.suggestions[i].value;}}}else{/* need to ensure we have the right mon selected */ var listLen=awesomplete.options.list.length; for (var i=0; i<listLen; i++){if (selected==awesomplete.options.list[i].label){/*console.log("mon set to selected==awesomplete.suggestions["+i+"].label:"+awesomplete.suggestions[i].label) */ mon=awesomplete.options.list[i].value;}}}var value=mon.split(','); /*console.log("value set to:"+JSON.stringify(value)); */ var output=document.getElementById('output'); /*console.log("start(): 'mon' received as:"+JSON.stringify(mon)); */ var base=document.getElementById('base').checked; /* ignore base for Hitmons */ if ((base) && (!(['106', '107', '237'].includes(value[0])))){/*console.log("Finding base evo, (['106', '107', '237'].includes(value):"+(['106', '107', '237'].includes(value[0]))) */ var baseID=10000; base=value[0]; baseID=value[0].split("&")[0]; /*console.log("Using base of:"+base); */ /*console.log("Using baseID of:"+baseID); */ for (var i=4; i<value.length; i++){if (value[i].indexOf("&") > 0){/*console.log("Found an '&' in an evolved form ("+value[i]+")!"); */ /* skip baby forms unless checked (baby=true) */ if ((value[i].split("&")[1]==="eggsonly") && (!baby)) continue; if (baseID > value[i].split("&")[0]){base=value[i]; baseID=value[i].split("&")[0];}}/* find base evolution */ if (baseID/1 > value[i]/1){base=value[i]; baseID=value[i]; /*console.log("Updated base evo to "+base); */}}/*console.log("Found base evo to be "+base); */}else{/* if we aren't using base evo, use the select mon's ID */ console.log("Skipping finding base evo, (['106', '107', '237'].includes(value):"+(['106', '107', '237'].includes(value[0]))); base=value[0];}var baby=document.getElementById('baby').checked; if (baby){baby=value[0]; for (var i=4; i<value.length; i++){if (value[i].indexOf("&") > 0){if (value[i].split("&")[1]==="eggsonly"){/*console.log("Found baby form! "+value[i]); */ base=value[i]; break;}}}/*console.log("Overwrote base evo with baby form:"+base); */}/* get base stats of whatever form we are outputting string for */ var baseatk, basedef, basesta, basemon=0; /*console.log("Can we print awesomeplete's list?"+JSON.stringify(awesomplete.suggestions)); */ /* found boolean fixes same dexNum forms displaying incorrectly (Rotom) */ var found=false; for (var i=0; i < awesomplete.options.list.length; i++){awesomplete.options.list[i].value.split(',')[0]; if (base===awesomplete.options.list[i].value.split(',')[0]){/*console.log("Found base("+base+") at i:("+i+")"); */ if (found){if (selected !==awesomplete.options.list[i].label){/*console.log("No match: selected("+selected+") !="+awesomplete.options.list[i].label+" at i:("+i+")"); */ continue;}}basemon=awesomplete.options.list[i].label; baseatk=awesomplete.options.list[i].value.split(',')[1]; basedef=awesomplete.options.list[i].value.split(',')[2]; basesta=awesomplete.options.list[i].value.split(',')[3]; found=true;}}var league=document.getElementById('league').value; var limit=document.getElementById('limit').value; var trash=document.getElementById('trash').checked; var hundo=document.getElementById('hundo').checked; var zero=document.getElementById('zero').checked; var onlyZero=document.getElementById('onlyZero').checked; var short=document.getElementById('short').checked; var lang=document.getElementById('lang').value.split(','); var cpstr=lang[1], hpstr=lang[2]; /* validate reCaptcha v3 */ /* code reference: https://www.simoahava.com/analytics/improve-google-analytics-bot-detection-with-recaptcha/ */ grecaptcha.ready(function(){grecaptcha.execute('6LfY-KYUAAAAAIYnP89WU5GWU-MMg_uy0z_7t9c2',{action: 'searchStr'}).then(function(token){/* Make xhr POST request to validate reCAPTCHA v3 */ console.log("Validating reCAPTCHA..."); var xhr=new XMLHttpRequest(); xhr.onload=function(){if ((xhr.response !=='noChange') && (xhr.response==='Success')){console.log("Success!");}else if (xhr.response==='Error'){output.value="ERROR"; console.log("Error! xhr.status:"+xhr.status+" xhr.responseText:"+JSON.stringify(xhr.responseText)); return false;}else{console.log("Unknown Response! xhr.status:"+xhr.status+" xhr.responseText:"+JSON.stringify(xhr.responseText));}}; xhr.open('POST', 'https://us-central1-sandbox-of-alex-gronbach-2.cloudfunctions.net/validateReCaptchaV3', true); xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded'); /* xhr.send('token=ERROR'); */ xhr.send('token=' + token + '&bqInsert=' + false + '&request=' + null);});}); /* build binary encoding of settings */ var binary=""; var calcOut; if (trash){binary="1";}else{binary="0";}if (onlyZero){binary +="1";}else{binary +="0";}if (hundo){binary +="1";}else{binary +="0";}if (zero){binary +="1";}else{binary +="0";}if (document.getElementById('base').checked){binary +="1";}else{binary +="0";}if (document.getElementById('baby').checked){binary +="1";}else{binary +="0";}if (short){binary +="1";}else{binary +="0";}/*console.log("Binary:"+binary); */ /* output the user's request! */ outputStr(value, base, basemon, baseatk, basedef, basesta, limit, trash, hundo, zero, onlyZero, short, league, binary, output, lang[1], lang[2]); /* update the URL with search parameters */ var uri=window.location.href.split("?")[0]; uri=encodeURI(uri + "?mon="+selected+"&r="+limit+"&cp="+league+"&o="+binary+"&l="+document.getElementById('lang').value.split(',')[0]); /*console.log("URI:"+uri); */ var newTitle="ShortcutIV - PvP Search Strings - " + "Rank " + limit + " " + selected + " ("+league+")"; window.history.pushState(null, newTitle, uri); if (canonicalLink){/* https://stackoverflow.com/questions/13735247/changing-the-href-of-a-link-tag-using-javascript */ /* <link rel="canonical" href="https://example.com/dresses/green-dresses"/> */ var newLink=document.createElement('link'); newLink.rel="canonical"; newLink.href="https://shortcutiv.com/searchStr.html"; document.getElementsByTagName("head")[0].appendChild(newLink); /*console.log("Added newLink("+newLink+") to head:"+document.getElementsByTagName('head')); */ canonicalLink=false;}return true;}function calculat3(baseatk, basedef, basesta, league, floor, minLvl, maxLvl, invalid){/* returns sorted list of all (up to 4096) combinations indexed by statProd + CP */ console.log("calculat3: Received: baseatk="+baseatk+" basedef="+basedef+" basesta="+basesta+" league="+league+" floor="+floor+" minLvl="+minLvl); /* Each item stored by statProd.CP */ /* Rank definition:{"12613615.1500":{"IVs":{"A":14, "D":14, "S":14, "star": "3*"}, "base":{"A":145, "D":105, "S":115}, "battle":{"A":145, "D":105, "S":115}, "L":25}, */ var ranks=[], invalids=[]; var maxAtk={value:0,aIV:0,dIV:0,sIV:0,sp:0}; var maxDef={value:0,aIV:0,dIV:0,sIV:0,sp:0}; var maxHP={value:0,aIV:0,dIV:0,sIV:0,sp:0}; var minAtk={value:1000,aIV:0,dIV:0,sIV:0,sp:0}; var minDef={value:1000,aIV:0,dIV:0,sIV:0,sp:0}; var minHP={value:1000,aIV:0,dIV:0,sIV:0,sp:0}; var numRanks=0; /* account for half-level CPMs (40-1)*2=78 */ minLvl=Math.max(0, (minLvl - 1) * 2); /* use half-levels */ maxLvl=Math.max(0, (maxLvl - 1) * 2); /* use half-levels */ /* cpm array used for calculations, source: https://www.reddit.com/r/TheSilphRoad/comments/eco7qc/exact_cpms_for_all_half_levels_between_level_40_45/ */ var cpm=[0.0939999967813492, 0.1351374320893390, 0.1663978695869450, 0.1926509131553250, 0.2157324701547620, 0.2365726514248220, 0.2557200491428380, 0.2735303721065720, 0.2902498841285710, 0.3060573813898630, 0.3210875988006590, 0.3354450319964510, 0.3492126762866970, 0.3624577366099390, 0.3752355873584750, 0.3875924077138780, 0.3995672762393950, 0.4111935532161000, 0.4225000143051150, 0.4329264205125090, 0.4431075453758240, 0.4530599481650490, 0.4627983868122100, 0.4723360853112780, 0.4816849529743190, 0.4908558071795490, 0.4998584389686580, 0.5087017489616000, 0.5173939466476440, 0.5259425161103220, 0.5343543291091920, 0.5426357538035990, 0.5507926940917970, 0.5588305844903850, 0.5667545199394230, 0.5745691281453700, 0.5822789072990420, 0.5898879078889450, 0.5974000096321110, 0.6048236486651710, 0.6121572852134700, 0.6194041079582340, 0.6265671253204350, 0.6336491787485760, 0.6406529545784000, 0.6475809713865540, 0.6544356346130370, 0.6612192658058590, 0.6679340004920950, 0.6745818856474920, 0.6811649203300480, 0.6876849012553730, 0.6941436529159550, 0.7005429010330630, 0.7068842053413390, 0.7131690748738230, 0.7193990945816040, 0.7255755869151540, 0.7317000031471250, 0.7347410385504290, 0.7377694845199580, 0.7407855797371360, 0.7437894344329830, 0.7467811972477650, 0.7497610449790950, 0.7527290997322810, 0.7556855082511900, 0.7586303702098510, 0.7615638375282290, 0.7644860495921800, 0.7673971652984620, 0.7702972936773620, 0.7731865048408510, 0.7760649470649920, 0.7789327502250670, 0.7817900507676660, 0.7846369743347170, 0.7874736085132750, 0.7903000116348270, 0.792803968023538, 0.7953000068664551, 0.7978038983716224, 0.8003000020980835, 0.8028038718775964, 0.8052999973297119, 0.8078038508470536, 0.8102999925613403, 0.812803835179168, 0.8152999877929688]; for(var atk=floor/1;atk<=15;atk++){for(var def=floor/1;def<=15;def++){for(var sta=floor/1;sta<=15;sta++){for( var level=maxLvl; level >=minLvl; level-- ){var cp=Math.max(10, Math.floor((baseatk + atk) * Math.sqrt(basedef + def) * Math.sqrt(basesta + sta) * cpm[level] * cpm[level] / 10)); if (cp > league){/*console.log("CP("+cp+") > league("+league+")");*/ if ((level==minLvl) && (invalid)){invalids.push({"A":atk, "D":def, "S":sta, "cp":cp});}continue; /* keep searching for level */}var aSt=(baseatk + atk)*cpm[level]; var dSt=(basedef + def)*cpm[level]; var sSt=Math.floor((basesta + sta)*cpm[level]); var statProd=Math.round(aSt * dSt * sSt); /* update maxStats if necessary */ if ((maxAtk.value < aSt) || ((maxAtk.sp < statProd) && (maxAtk.value <=aSt))){maxAtk.value=aSt;maxAtk.aIV=atk;maxAtk.dIV=def;maxAtk.sIV=sta;maxAtk.sp=statProd;}if ((maxDef.value < dSt) || ((maxDef.sp < statProd) && (maxDef.value <=dSt))){maxDef.value=dSt;maxDef.aIV=atk;maxDef.dIV=def;maxDef.sIV=sta;maxDef.sp=statProd;}if ((maxHP.value < sSt) || ((maxHP.sp < statProd) && (maxHP.value <=sSt))){maxHP.value=sSt;maxHP.aIV=atk;maxHP.dIV=def;maxHP.sIV=sta;maxHP.sp=statProd;}/* update minStats if necessary */ if ((minAtk.value > aSt) || ((minAtk.sp < statProd) && (minAtk.value >=aSt))){minAtk.value=aSt;minAtk.aIV=atk;minAtk.dIV=def;minAtk.sIV=sta;minAtk.sp=statProd;}if ((minDef.value > dSt) || ((minDef.sp < statProd) && (minDef.value >=dSt))){minDef.value=dSt;minDef.aIV=atk;minDef.dIV=def;minDef.sIV=sta;minDef.sp=statProd;}if ((minHP.value > sSt) || ((minHP.sp < statProd) && (minHP.value >=sSt))){minHP.value=sSt;minHP.aIV=atk;minHP.dIV=def;minHP.sIV=sta;minHP.sp=statProd;}var IVsum=atk/1 + def/1 + sta/1; var Star="NA"; if (IVsum<23){Star="0*";}else if(IVsum<30){Star="1*";}else if (IVsum<37){Star="2*";}else if(IVsum<45){Star="3*";}else{Star="4*";}level=level/2 + 1; /* store as arrays to prevent hash collisions from dropping entires */ /* Tie Breaking Order: 1)StatProd -> 2)AtkStat -> 3)HPval -> 4)finalCP -> 5)ERROR */ var newIndex=statProd+"."+Math.round(100000*aSt); if (!(newIndex in ranks)){ranks[newIndex]=[{"IVs":{"A":atk, "D":def, "S":sta, "star":Star}, "battle":{"A":aSt, "D":dSt, "S":sSt}, "L":level, "CP":cp}];}else{var i,collision=false; var ranksLen=ranks[newIndex].length; for (i=0; i<ranksLen; i++){if (sSt > ranks[newIndex][i].battle.S){break;}else if (sSt==ranks[newIndex][i].battle.S){if (cp > ranks[newIndex][i].CP){break;}else if (cp==ranks[newIndex][i].CP){collision=true;}}}ranks[newIndex].splice(i, 0,{"IVs":{"A":atk, "D":def, "S":sta, "star":Star}, "battle":{"A":aSt, "D":dSt, "S":sSt}, "L":level, "CP":cp}); if (collision===true){console.log("Need 5th tie breaker for newIndex("+newIndex+"):"+JSON.stringify(ranks[newIndex]));}}numRanks=numRanks + 1; break; /* stop evaluating this IV combination */}}}}/* sort by statProd+CP before returning */ const sorted={}; Object.keys(ranks).sort(function(a, b){return b-a;}).forEach(function(key){sorted[key]=ranks[key];}); /* add max stats to object */ sorted.maxAtk=maxAtk; sorted.maxDef=maxDef; sorted.maxHP=maxHP; sorted.minAtk=minAtk; sorted.minDef=minDef; sorted.minHP=minHP; sorted.numRanks=numRanks; sorted.invalids=invalids; /* console.log("calculat3 output:"+JSON.stringify(sorted, null, 2)); */ return sorted;}function outputStr(value, id, mon, baseatk, basedef, basesta, limit, trash, hundo, zero, onlyZero, short, league, binary, output, cpstr, hpstr){console.log("outputStr: value[1]:"+value[1]+", value[2]:"+value[2]+", value[3]:"+value[3]+", id:"+id+", mon:"+mon+", baseatk:"+baseatk+", basedef:"+basedef+", basesta:"+basesta+", limit:"+limit+", trash:"+trash+", hundo:"+hundo+", zero:"+zero+", onlyZero:"+onlyZero+", league:"+league+", cpstr:"+cpstr+", hpstr:"+hpstr); var ranks, maxCP, rKeys, mergedRanks; if (league=="All"){var ULranks, ULkeys, ULlen; maxCP=Math.max(10, Math.floor((value[1]/1 + 15) * Math.sqrt(value[2]/1 + 15) * Math.sqrt(value[3]/1 + 15) * cpm[(40 - 1)*2] * cpm[(40 - 1)*2] / 10)); if (maxCP/1 < 1500){/* Only have to worry about Great League */ console.log("maxCP is: "+maxCP+", only need to do Great League"); mergedRanks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), 1500, 0, 0, 40); rKeys=Object.keys(mergedRanks); for (var i=document.getElementById('GLlimit').value/1; i<rKeys.length ;i++){delete mergedRanks[rKeys[i]];}}else if (maxCP/1 < 2500){/* Only have to worry about Great + Ultra League */ console.log("maxCP is: "+maxCP+", only need Great + Ultra League"); ranks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), 1500, 0, 0, 40); ULranks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), 2500, 0, 0, 40); rKeys=Object.keys(ranks); for (var i=document.getElementById('GLlimit').value/1; i<rKeys.length ;i++){delete ranks[rKeys[i]];}ULkeys=Object.keys(ULranks); for (var i=document.getElementById('ULlimit').value/1; i<ULkeys.length ;i++){delete ULranks[ULkeys[i]];}mergedRanks={...ranks, ...ULranks}; mergedRanks.numRanks=document.getElementById('GLlimit').value/1 + document.getElementById('ULlimit').value/1; console.log("Finished merging GL and UL ranks arrays");}else{/* Need all 3 Leagues */ console.log("maxCP is: "+maxCP+", need all 3 PvP Leagues"); ranks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), 1500, 0, 0, 40); rKeys=Object.keys(ranks); for (var i=document.getElementById('GLlimit').value/1; i<rKeys.length ;i++){delete ranks[rKeys[i]];}ULranks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), 2500, 0, 0, 40); ULkeys=Object.keys(ULranks); for (var i=document.getElementById('ULlimit').value/1; i<ULkeys.length ;i++){delete ULranks[ULkeys[i]];}var MLranks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), 5000, 0, 0, 40); MLkeys=Object.keys(MLranks); for (var i=document.getElementById('MLlimit').value/1; i<MLkeys.length ;i++){delete MLranks[MLkeys[i]];}mergedRanks={...ranks, ...ULranks, ...MLranks}; mergedRanks.numRanks=document.getElementById('GLlimit').value/1 + document.getElementById('ULlimit').value/1 + document.getElementById('MLlimit').value/1;}}else{mergedRanks=calculat3(parseInt(value[1]), parseInt(value[2]), parseInt(value[3]), league, 0, 0, 40); rKeys=Object.keys(mergedRanks); for (var i=document.getElementById('GLlimit').value/1; i<rKeys.length ;i++){delete mergedRanks[rKeys[i]];}}/*console.log("outputStr mergedRanks="+JSON.stringify(mergedRanks));*/ rKeys=Object.keys(mergedRanks); var rLength=(league !="All") ? limit:mergedRanks.numRanks; /*var rLength=rKeys.length - 7; /* remove all 3 max stat entries, all 3 min stat entries and numRanks */ output.value=''; /* ensure old output and feedback are both */ document.getElementById('feedbackBox').innerHTML=""; /* cleared */ var cps=[], hps=[], results; cps[0]=new Set(); hps[0]=new Set(); cps[1]=new Set(); hps[1]=new Set(); cps[2]=new Set(); hps[2]=new Set(); cps[3]=new Set(); hps[3]=new Set(); cps[4]=new Set(); hps[4]=new Set(); maxCP=new Array(5).fill(0), maxHP=new Array(5).fill(0); if (onlyZero){if (trash){message="This string only finds 0% IVs, and is NOT a trash string. Please uncheck 'Trash String' (top)"; document.getElementById('feedbackBox').innerHTML="<p><i>"+message+"</i></p>";}else{message="This string ignores PvP rankings. For PvP rankings please uncheck 'Only Find 0% IVs' (top)"; document.getElementById('feedbackBox').innerHTML="<p><i>"+message+"</i></p>";}results=getZeroCPs(baseatk, basedef, basesta, cpm, maxCP, maxHP, cps[0], hps[0]); cps[0]=results[0]; hps[0]=results[1]; maxCP=results[2]; maxHP=results[3]; outputCPsHPs(cps, maxCP, hps, maxHP, output, id, cpstr, hpstr, trash, zero, hundo, onlyZero, short); message="String finds only potential 0% IV (0/0/0) "+mon+", not PvP ranks"; document.getElementById('outputSummaryBox').innerHTML="<p>"+message+"</p>"; return output;}else{if ((!zero) && (trash)){results=getZeroCPs(baseatk, basedef, basesta, cpm, maxCP, maxHP, cps[0], hps[0]); cps[0]=results[0]; hps[0]=results[1]; maxCP=results[2]; maxHP=results[3];}/* generate all the cps and hps for matching */ /* for ranks 1 to user limit, up to maxLvl (L) for league */ for (var i=0; i<rLength; i++){for (var j=0; j<mergedRanks[rKeys[i]].length; j++){/* start at maxLvl (up to league limit) */ var maxLvl=(mergedRanks[rKeys[i]][j].L - 1)*2; /* see if this is a half-level (these don't spawn in the wild) */ if (maxLvl%2 !=0){/* ensure we build search string only on "full" levels */ maxLvl=maxLvl - 1; /* set to non-half level */}/* skip half level CPs in search strings to improve accuracy */ for( var level=maxLvl; level >=0; level=level - 2 ){var cp=Math.max(10, Math.floor((baseatk/1 + mergedRanks[rKeys[i]][j].IVs.A) * Math.sqrt(basedef/1 + mergedRanks[rKeys[i]][j].IVs.D) * Math.sqrt(basesta/1 + mergedRanks[rKeys[i]][j].IVs.S) * cpm[level] * cpm[level] / 10)); /* generate hps for more accurate search string matching */ var hp=Math.max(10, Math.floor((basesta/1 + mergedRanks[rKeys[i]][j].IVs.S) * cpm[level])); /* bucket CPs and HPs into appraisal ratings for more accurrate matching */ switch (mergedRanks[rKeys[i]][j].IVs.star){case "0*": cps[0].add(cp); hps[0].add(hp); if (maxCP[0] < cp){maxCP[0]=cp;}if (maxHP[0] < hp){maxHP[0]=hp;}break; case "1*": cps[1].add(cp); hps[1].add(hp); if (maxCP[1] < cp){maxCP[1]=cp;}if (maxHP[1] < hp){maxHP[1]=hp;}break; case "2*": cps[2].add(cp); hps[2].add(hp); if (maxCP[2] < cp){maxCP[2]=cp;}if (maxHP[2] < hp){maxHP[2]=hp;}break; case "3*": cps[3].add(cp); hps[3].add(hp); if (maxCP[3] < cp){maxCP[3]=cp;}if (maxHP[3] < hp){maxHP[3]=hp;}break; case "4*": cps[4].add(cp); hps[4].add(hp); if (maxCP[4] < cp){maxCP[4]=cp;}if (maxHP[4] < hp){maxHP[4]=hp;}break;}}}}}/* output the CPs and HPs */ /* var newArray=oldArray.slice(); */ outputCPsHPs(cps.slice(), maxCP, hps.slice(), maxHP, output, id, cpstr, hpstr, trash, zero, hundo, onlyZero, short); if (output.value.length > 2000){console.log("Too long for iOS:"+output.value.length+" with short:"+short); if (short===false){var uri=window.location.href.split("?")[0]; uri=encodeURI(uri + "?mon="+selected+"&r="+limit+"&cp="+league+"&o="+binary.replace(/.$/,'1')+"&l="+document.getElementById('lang').value.split(',')[0]); message="This string is "+output.value.length+" characters long, which is over the 2000 character iOS Text Replacement limit. Please <a href='"+uri+"'>click here</a> to re-generate this Search String with truncation enabled to ensure the output is <2000 characters."; document.getElementById('feedbackBox').innerHTML="<p><i>"+message+"</i></p>"; document.getElementById('output2').value=output.value.slice(0, 2000); document.getElementById('output3').value=output.value.slice(2001, 4000); document.getElementById('output4').value=output.value.slice(4001, 6000); document.getElementById('output5').value=output.value.slice(6001, output.value.length);}else{outputCPsHPs(cps.slice(), maxCP, hps.slice(), maxHP, output, id, cpstr, hpstr, trash, zero, hundo, onlyZero, short); if (output.value.length > 2000){message="This string is "+output.value.length+" characters long, which is over the 2000 character iOS Text Replacement limit. Please narrow the scope of your Search String and try again to ensure the output is <2000 characters."; document.getElementById('feedbackBox').innerHTML="<p><i>"+message+"</i></p>"; document.getElementById('output2').value=output.value.slice(0, 2000); document.getElementById('output3').value=output.value.slice(2001, 4000); document.getElementById('output4').value=output.value.slice(4001, 6000); document.getElementById('output5').value=output.value.slice(6001, output.value.length);}}}if (mon=="Burmy"){if (selected=="Mothim"){console.log("Found Mothim!"); output.value +="&male";}else if (selected.indexOf("Wormadam") > -1 ){console.log("Found:"+mon); output.value +="&female";}}/* let the user know what we just output */ var message=""; /*var printLimit=Math.min(limit, numRanks);*/ if ((trash) && (!onlyZero)){if ((hundo) && (zero)){message="String trashes all "+mon+" except Top "+rLength+ " PvP "+selected;}else if ((!hundo) && (zero)){message="String trashes all "+mon+" except perfect IV (15/15/15) and Top "+rLength+ " PvP "+selected;}else if ((hundo) && (!zero)){message="String trashes all "+mon+" except zero IV (0/0/0) and Top "+rLength+ " PvP "+selected;}else{message="String trashes all "+mon+" except perfect IV (15/15/15) and zero IV (0/0/0) and Top "+rLength+ " PvP "+selected;}}else{message="String finds Top "+rLength+ " "+mon+", for PvP "+selected;}/*console.log(message); */ document.getElementById('outputSummaryBox').innerHTML="<p>"+message+"</p>"; return output;}function getZeroCPs(baseatk, basedef, basesta, cpm, maxCP, maxHP, cps, hps){/* generate all the cps and hps for matching */ var maxLvl=(30 - 1)*2; /* highest level possible without IV boost (L30) */ /* see if this is a half-level (these don't spawn in the wild) */ if (maxLvl%2 !=0){/* ensure we build search string only on "full" levels */ maxLvl=maxLvl - 1; /* set to non-half level */}/* skip half level CPs in search strings to improve accuracy */ for( var level=maxLvl; level >=0; level=level - 2 ){var cp=Math.max(10, Math.floor((baseatk/1 + 0) * Math.sqrt(basedef/1 + 0) * Math.sqrt(basesta/1 + 0) * cpm[level] * cpm[level] / 10)); /* generate hps for more accurate search string matching */ var hp=Math.max(10, Math.floor((basesta/1 + 0) * cpm[level])); /* update counters for maxCP and maxHP */ if (maxCP[0] < cp){maxCP[0]=cp;}if (maxHP[0] < hp){maxHP[0]=hp;}cps.add(cp); hps.add(hp);}return [cps, hps, maxCP, maxHP];}function outputCPsHPs(cps, maxCP, hps, maxHP, output, id, cpstr, hpstr, trash, zero, hundo, onlyZero, short){/*console.log("outputCPsHPs: maxCP:"+JSON.stringify(maxCP)+", maxHP:"+JSON.stringify(maxHP)+", trash:"+trash+" zero:"+zero+", hundo:"+hundo+", onlyZero:"+onlyZero+", short:"+short);*/ var maxLoops=5, allCPs, allHPs, allMaxCP, allMaxHP, hpBuf; if (short){/* save for later */ /* merge all CPs and HPs into one set */ var tempCPs=[], tempHPs=[]; for (var i=0; i<maxLoops; i++){tempCPs=tempCPs.concat(Array.from(cps[i])); tempHPs=tempHPs.concat(Array.from(hps[i]));}/* https://stackoverflow.com/a/9229821 */ allCPs=new Set([...new Set(tempCPs)]); allHPs=new Set([...new Set(tempHPs)]); allMaxCP=Math.max(...maxCP); allMaxHP=Math.max(...maxHP);}/* get actual maxCP and maxHP using spread syntax */ var emptyBuf=""; output.value=id; /* add dex num */ if (onlyZero){maxLoops=1;}/* only process 0* if onlyZero is true */ /* output cps and hps, skip empty sets (size==0) */ for (var i=0; i<maxLoops; i++){if (cps[i].size > 0){if (i==4){if ((trash) && (!hundo)){emptyBuf +='&!'+i+'*';}else{emptyBuf +=','+i+'*';}}else{if ((trash) && (!onlyZero)){cps[i]=trashFlip(cps[i], maxCP[i]); if (!short){hps[i]=trashFlip(hps[i], maxHP[i]);}}cps[i]=Array.from(cps[i]); cps[i].sort((a, b)=> a - b); output.value +='&!'+i+'*,' + get_matching_string(cps[i], cpstr); if (!short){/* skip HPs to save characters */ hps[i]=Array.from(hps[i]); hps[i].sort((a, b)=> a - b); if (!trash){output.value +='&!'+i+'*';}output.value +=',' + get_matching_string(hps[i], hpstr);}}}else if (trash){if ((i==0) && (cps[0].size==0) && (cps[1].size==0) && (cps[2].size==0) && (cps[3].size==0) && (cps[4].size > 0)){/* correct rank 1 trash string when rank 1 is 4* (Medi) */ emptyBuf +='&'+i+'*';}else{if ((!hundo) && (i==4)){emptyBuf +='&!'+i+'*';}else{emptyBuf +=','+i+'*';}}}else{/* skip empty appraisal sets in search string */ emptyBuf +='&!'+i+'*';}}output.value +=emptyBuf; /* add trash stuff */ console.log("Generated string is "+output.value.length+" characters long"); if (output.value.length > 2000){document.getElementById('output2').value=output.value.slice(0, 2000); document.getElementById('output3').value=output.value.slice(2001, 4000); document.getElementById('output4').value=output.value.slice(4001, 6000); document.getElementById('output5').value=output.value.slice(6001, output.value.length);}if ((short) && (output.value.length > 2000)){console.log("Regenerating string to try to be under 2000 character limit..."); /* fall back to old system to save characters */ output.value=""; /* clear the old and too long output */ if (trash){/* flip CPs and HPs for trashing */ allCPs=trashFlip(allCPs, allMaxCP); allHPs=trashFlip(allHPs, allMaxHP); /* output CPs and HPs */ allCPs=Array.from(allCPs); allCPs.sort((a, b)=> a - b); output.value +=id + '&' + get_matching_string(allCPs, cpstr); hpBuf=""; if (output.value.length < 2000){allHPs=Array.from(allHPs); allHPs.sort((a, b)=> a - b); hpBuf=',' + get_matching_string(allHPs, hpstr); if ((output.value.length + hpBuf.length) <=2000){output.value +=hpBuf;}else{console.log("output.value.length:"+output.value.length+" + hpBuf.length:"+hpBuf.length+" will be over 2000 char limit, dropping hpBuf");}}else{console.log("output.value.length:"+output.value.length+" is over 2000 char limit, skipped hpBuf");}}else{/* output CPs and HPs */ allCPs=Array.from(allCPs); allCPs.sort((a, b)=> a - b); output.value +=id + '&' + get_matching_string(allCPs, cpstr); hpBuf=""; if (output.value.length < 2000){allHPs=Array.from(allHPs); allHPs.sort((a, b)=> a - b); allHPs='&' + get_matching_string(allHPs, hpstr); if ((output.value.length + hpBuf.length) <=2000){output.value +=hpBuf;}else{console.log("output.value.length:"+output.value.length+" + hpBuf.length:"+hpBuf.length+" will be over 2000 char limit, dropping hpBuf");}}}if ((trash) && (!hundo) && (!onlyZero)){output.value +='&!4*';}}console.log("Final length:"+output.value.length); return true;}function trashFlip(cps, maxCP){if (cps instanceof Set){/*console.log("trashFlip: Entering loop with maxCP:"+maxCP+" cps("+cps+"):"+JSON.stringify(Array.from(cps).sort((a, b)=> a - b))); */ for (var i=10; i<=maxCP; i++){if( cps.has(i) ){cps.delete(i);}else{cps.add(i);}}/*console.log("trashFlip: After loop cps:"+JSON.stringify(Array.from(cps).sort((a, b)=> a - b))); */ return cps;}else{console.log("trashFlip: ERROR: received cps as "+typeof cps+" instead of expected set"); document.getElementById('feedbackBox').innerHTML="ERROR: Please try again. If this persists, please send us the URL via Discord!"; return false;}}function get_matching_string(a, t){var list='', last=-1; for( var i=0; i < a.length; i++ ){if( a[i]==last + 1 ){list +='-'; last=a[i]; while( ++i < a.length ){if( a[i] !=last + 1 ) break; last=a[i];}if( a[--i] < 9999 ){list +=a[i];}}else{list +=',' + t + a[i]; last=a[i];}}return list.substr(1);}function autocopy(e){e.select(); document.execCommand('copy');}</script> <h3>Settings:</h3> <label>Trash Perfect IVs:<input id="hundo" type="checkbox" checked oninput="start()"></label><br/> <label>Trash Zero IVs:<input id="zero" type="checkbox" checked oninput="start()"></label><br/> <label>Use Base Evolution:<input id="base" type="checkbox" checked oninput="start()"></label><br/> <label>Use Baby Form:<input id="baby" type="checkbox" oninput="start()"></label><br/> <label>2000 Character Max (iOS):<input id="short" type="checkbox" oninput="start()"></label><br/> <label>Language:<select id="lang" oninput="start()"> <option value="en,cp,hp">English</option> <option value="ja,cp,hp">Japanese</option> <option value="fr,pc,pv">French</option> <option value="es,pc,puntos de salud">Spanish</option> <option value="de,wp,kp">German</option> <option value="il,pl,punti salute">Italian</option> <option value="ko,cp,hp">Korean</option> <option value="zh,cp,hp">Chinese</option> <option value="pt,pc,ps">Portuguese</option></select> </label><br/><br/> <textarea id="output2" rows="1" style="width: 50%; height: 50%;" onclick="autocopy(this)"></textarea> <textarea id="output3" rows="1" style="width: 50%; height: 50%;" onclick="autocopy(this)"></textarea> <textarea id="output4" rows="1" style="width: 50%; height: 50%;" onclick="autocopy(this)"></textarea> <textarea id="output5" rows="1" style="width: 50%; height: 50%;" onclick="autocopy(this)"></textarea> <div style="overflow-x:auto;"><br/> <p style="color:silver;font-size:0.6em">This site is protected by reCAPTCHA and the Google <a style="color:#AED6F1" href="https://policies.google.com/privacy">Privacy Policy</a> and <a style="color:#AED6F1" href="https://policies.google.com/terms">Terms of Service</a> apply.</p></div></section> </body></html>